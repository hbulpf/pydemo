# Python总结与复习

> ```
> # -*- coding: utf-8 -*-
> ```

## 基本语法

### 数据类型

Python的数据类型有 

1. 整数
2. 浮点数
3. 字符串 `'str1'` / `"str2"` / `''' str3'''` / `"""str4"""`
4. 布尔值: True / False
5. 空值: None , 是一个特殊的空值。 
6. 常量: 通常用全部大写的变量名表示常量, 只是一个习惯,值可以被改变

变量

```
a = 5 <= 3 or True
a = 10 % 3 + 10 // 3  #地板除得到整数
a = 10 % 3 + 10 / 3 #除法得到浮点数
a = 2**3 #计算乘方
a = 'ABC' 
b = a
a = 'XYZ' #输出b: ABC, a和b都是地址
PI = 3.1415
```



### 输入/输出

#### 从键盘输入
```
name = input('Please enter your name: ')
print(name)
```

#### 输出字符串

##### 字节

```
#b表示bytes
print('ABC'.encode('ascii'))
print('ABC'.encode('utf-8'))
print('中文'.encode('utf-8'))
a = b'\xe4\xb8\xad\xff'.decode('utf-8',errors='ignore')
print(a)
print(len(a),len(b'\xe4\xb8\xad'),len('中'.encode('utf-8')))
print('中文测试正常')
```

##### 不转义

`r` 表示内部字符默认不转义
```
print(r'seek\t\n\\')
print('''line1
line2
line3''')
print(r'''line1
line2
line3''')
```

##### 字符串格式化

```
#格式化方式1
print('age: %d, name: %s, stunum: %04d, ave_score:%.2f' % (25, '然然', 32, 73.1415926))

#格式化方式2: format()
print('{0}成绩提升了{1:.2f}%'.format('童童', 5.2316))
print('my name is {0}, I am {1} years old. Please call me {0}'.format('陈明',12))

#格式化方式3: f-string
r = 2.5
s = 3.14 * r ** 2
print(f'The area of a circle with radius {r} is {s:.2f}')
```

| 占位符 | 替换内容     |
| :----- | :----------- |
| %d     | 整数         |
| %f     | 浮点数       |
| %s     | 字符串       |
| %x     | 十六进制整数 |

##### 字符串其他操作

替换字符

```
a = 'abc'
b = a.replace('a', 'A')
```



###  条件与循环

条件语句
```
height = float(input('height: '))
weight = float(input('weight: '))
bmi = weight / height**2
if bmi < 18.5:
    print('过轻')
elif bmi >= 18.5 and bmi < 25:
    print('正常')
elif bmi >= 25 and bmi < 28:
    print('过重')
else:
    print('肥胖')

if age >= 18:
    #什么都不做
    pass
```

for循环
```
names = ['Michael', 'Bob', 'Tracy']
for name in names:
    print(name)
    
sum = 0
for x in range(101):
    sum = sum + x
if sum == 5050:
    print('Gauss is correct.')
else:
    print('Gauss is wrong.')
d = {'a': 1, 'b': 2, 'c': 3}   
for key in d:
     print(key)
```

> range() 函数左闭右开

while循环

```
n = 201
pow = 1
while n > 0:
	n = n - 1
	if n % 5 == 0:
		continue
	pow = pow * n
print(pow)
```

### 字典/集合/列表/元组

dictionary 字典，对应于其他语言的map结构
```
#创建dic
ad = {'mar': 13, (1,2):55,'wat': 67} 

#判断key是否存在
'mar' in ad
#取值
ad['hap'] #不存在抛异常
ad.get('mar') #不存在返回None
ad.get('mar',-1) #不存在返回指定值-1

#增加key
ad['hap'] = 23 
#删除key
ad.pop('mar')
print(ad)
```

set 集合
```
s = set([2,2,3,(1,2),5]) #要创建一个set，需要提供一个list作为输入集合
s.add(4) #添加元素
s.remove(4) #删除元素
se = set([5,2,(2,3)])
print(se & s) #set做交集
print(se | s) #set做并集

```

list 列表
```
roommate = ['suhong','ziheng','siyuan'] #创建list
len(roommate) #获取list中元素个数
print(roommate[2]) #取list中元素
print(roommate[-1]) #取list中元素
roommate.append('xinran') #追加元素
roommate.insert(1,['panpan','xinran']) #指定位置添加元素
roommate.pop() #删除末尾元素
roommate.pop(i) #删除索引i处的元素

roommate.sort() #对list进行排序

```

tuple 元组,不可变
```
she = ('suhong',) #创建tuple
she1 = ('suhong') #这不是创建tuple
she2 = () #创建空tuple
roommate = ('suhong', 'siyuan', ['panpan', 'ziheng'])
roommate[2][1] = 'bianbian'
print(roommate)
print(len(roommate))
```

## 函数

> [python内置函数列表](https://docs.python.org/3/library/functions.html)

对函数的理解: 函数名其实就是指向一个函数对象的引用，完全可以把函数名赋给一个变量，相当于给这个函数起了一个“别名”：

```
a = abs # 变量a指向abs函数
a(-1) # 所以也可以通过a调用abs函数
```

### 定义函数

```
#定义一个函数
def my_abs(x):
    if not isinstance(x, (int, float)):
        raise TypeError('bad operand type')
    if x >= 0:
        return x
    else:
        return -x

#定义空函数
def nop():
    pass     
    
#定义函数返回多个值    
def move(x, y, step, angle=0):
    nx = x + step * math.cos(angle)
    ny = y - step * math.sin(angle)
    return nx, ny   
 x, y = move(100, 100, 60, math.pi / 6)    #返回多值实际上是返回tuple 
```

### 函数参数

```
def move(x, y, step, angle=0):
```

1. 位置参数 :  x,y,step叫做位置参数。

2. 默认参数 : angle=0 叫默认参数。**定义默认参数要牢记一点：默认参数必须指向不变对象！**

   ```
   def add_end(L=[]): #这种定义指向了可变对象,错误
   def add_end(L=None): #这种定义执行不变对象，正确
   ```

3. 可变参数: 传入一列值或一个list,tuple

   ```
   def calc(*numbers):
       sum = 0
       for n in numbers:
           sum = sum + n * n
       return sum
   calc(1, 2) 
   
   nums = [1, 2, 3]
   calc(*nums) #在list或tuple前面加一个*号,表示list的所有元素作为可变参数传进去
   ```

   可变参数在函数调用时自动组装为一个tuple

4. 关键字参数

   ```
   def person(name, age, **kw):
       print('name:', name, 'age:', age, 'other:', kw)
   
   person('Michael', 30)    
   person('Bob', 35, city='Beijing')
   extra = {'city': 'Beijing', 'job': 'Engineer'}
   person('Jack', 24, **extra)
   ```

   关键字参数在函数内部自动组装为一个dic

5. 命名关键字参数

   ```
   def person(name, age, *, city, job):
       print(name, age, city, job)
   def man(name, age, *, city='Beijing', job):
       print(name, age, city, job)    
   
   #函数定义中已经有了一个可变参数，后面跟着的命名关键字参数就不再需要一个特殊分隔符*了
   def person(name, age, *args, city, job):
       print(name, age, args, city, job)    
   ```

   如果没有可变参数，就必须加一个`*`作为特殊分隔符。如果缺少`*`

其中默认参数、可变参数、关键字参数都可传可不传；位置参数和命名关键字参数必须传入。

参数定义的顺序必须是：位置参数、默认参数、可变参数、命名关键字参数和关键字参数。

> 对于任意函数，都可以通过类似`func(*args, **kw)`的形式调用它，无论它的参数是如何定义的。使用参考[廖雪峰博客函数的参数](https://www.liaoxuefeng.com/wiki/1016959663602400/1017261630425888)

### 递归函数

```
def fact(n):
    if n==1:
        return 1
    return n * fact(n - 1)
```

## 高级特性

### 切片

```
L = ['Michael', 'Sarah', 'Tracy', 'Bob', 'Jack']
L[0:3] #取前3个元素,等同于 L[:3]
L[-2:] #从倒数第2个元素开始，取到 L[len-2],L[len-1]
L[-3:-1] #从倒数第2个元素开始,到倒数第1个元素，取到 L[len-3],L[len-2]
L[-1:-3:-1] #从最后一个元素开始，倒数取，取到 L[len-1],L[len-2]，等同于L[:-3:-1] 
```

tuple也是一种list，唯一区别是tuple不可变

```
(0, 1, 2, 3, 4, 5)[:3]
```

字符串`'xxx'`也可以看成是一种list

```
'ABCDEFG'[::2]
```

> Python没有针对字符串的substring截取函数，只需要切片一个操作就可以完成

### 迭代

```
d = {'a': 1, 'b': 2, 'c': 3}
for key in d:
    print(key)
for value in d.values()
for k, v in d.items()
```

只要作用于一个可迭代对象，`for`循环就可以正常运行。判断可迭代对象

```
from collections.abc import Iterable
isinstance('abc', Iterable)
```

对`list`实现循环下标

```
for i, value in enumerate(['A', 'B', 'C']):
    print(i, value)
```

`for` 循环可以同时引用多个变量

```
for x, y in [(1, 1), (2, 4), (3, 9)]:
    print(x, y)
```

### 列表生成式

未来代替繁琐的for循环

```
[x * x for x in range(1, 11)]
[x * x for x in range(1, 11) if x % 2 == 0]
[m + n for m in 'ABC' for n in 'XYZ']
d = {'x': 'A', 'y': 'B', 'z': 'C' }
[k + '=' + v for k, v in d.items()]

L = ['Hello', 'World', 'IBM', 'Apple']
[s.lower() for s in L]
```

常用例子: 列出当前目录下的所有文件和目录名

```
import os
[d for d in os.listdir('.')]
```

在`for`后面的`if`是一个筛选条件，不能带`else`.`for`前面的部分是一个表达式，它必须根据`x`计算出一个结果，必须带 else

```
[x if x % 2 == 0 else -x for x in range(1, 11)]
```

### 生成器

Python中，这种一边循环一边计算的机制，称为生成器：generator。

创建生成器

```
L = [x * x for x in range(10)] #这是1个list
g = (x * x for x in range(10)) #这是1个生成器
```

通过`next()`函数获得generator

```
next(g)
```

generator保存的是算法，每次调用`next(g)`，就计算出`g`的下一个元素的值，直到计算到最后一个元素，没有更多的元素时，抛出`StopIteration`的错误。

实际上最常用到for取生成器的元素

```
g = (x * x for x in range(10))
for n in g:
    print(n)
```

经常将函数作为生成器

```
def fib(max):
    n, a, b = 0, 0, 1
    while n < max:
        yield b
        a, b = b, a + b
        n = n + 1
    return 'done'
>>> f = fib(6)
>>> f
<generator object fib at 0x104feaaa0>  
#取fib的值
while True:
    try:
        x = next(f)
        print('f:', x)
    except StopIteration as e:
        print('Generator return value:', e.value)
        break
```

`fib`函数是一个生成器。

generator和函数的执行流程不一样。函数是顺序执行，遇到`return`语句或者最后一行函数语句就返回。而变成generator的函数，在每次调用`next()`的时候执行，遇到`yield`语句返回，再次执行时从上次返回的`yield`语句处继续执行。即 **普通函数调用直接返回结果；generator函数的“调用”实际返回一个generator对象**

### 迭代器

凡是可作用于`for`循环的对象都是`Iterable`类型；

凡是可作用于`next()`函数的对象都是`Iterator`类型，它们表示一个惰性计算的序列；

集合数据类型如`list`、`dict`、`str`等是`Iterable`但不是`Iterator`，不过可以通过`iter()`函数获得一个`Iterator`对象。详细参考[廖雪峰博客迭代器](https://www.liaoxuefeng.com/wiki/1016959663602400/1017323698112640)

## 函数式编程

# 参考

1. [廖雪峰 Python基础](https://www.liaoxuefeng.com/wiki/1016959663602400/1017063413904832)